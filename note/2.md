## ch2

```
-main
|_java
| |_com.example.demo
|   |_ButtonActivity
|   |_MainActivity
|   |_TextViewActivity
|_res
  |_drawable
  | |_bg_btn1.xml  bg_btn3.xml  bg_btn4.xml
  | |_bird.png
  |
  |_layout
  | |_activity_button.xml
  | |_activity_main.xml
  | |_activity_text_view.xml
  |
  |_values
    |_colors.xml
    |_strings.xml
    |_styles.xml
    
    
```





### 2-1-1 LinearLayout

掌握基本属性：

必须设置orientation属性，不然多个元素时，就会出问题

```xml-dtd
- android:id
- android:layout_width
- android:layout_height
- android:layout_margin
- android:layout_padding
- android:orientation // 只有LinearLayout 才有RelatirveLayout没有这个属性
- android:background

```

tip：`MainActivity`是启动的Acitivity ，因为在`Manifest.xml`中被声明了启动`LAUNCHER`

`MainActivity`中最重要的生命周期函`OnCreate()`



### 2-1-2RelativeLayout

掌握基本属性：

```xml-dtd
android:layout_toLeftOf
android:alignBottom
android:alignParentBottom
android:below
```



### 2-2TextView

基本点：

```xml-dtd
-文字大小 color
<TextView
        android:id="@+id/tv_1"
        android:text="@string/tv_test1"
        android:textColor="@color/colorAccent"
        android:textSize="30sp"

        android:layout_width="wrap_content"
        android:layout_height="wrap_content" />

-显示省略
<TextView
        android:id="@+id/tv_2"
        android:text="runing runing runing runing runing"
        android:textColor="@color/colorAccent"
        android:textSize="30sp"
        android:maxLines="1"
        android:ellipsize="end"
        android:layout_marginTop="30dp"
        android:layout_width="100dp"
        android:layout_height="wrap_content" />
-文字+icon

    <TextView
        android:id="@+id/tv_3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Fiter"
        android:textColor="@color/colorPrimaryDark"
        android:textSize="30sp" />
2个方式，最简单是设置属性 `android:drawable`
或者，在 TextView.JAVA文件中
public class TextViewActivity extends AppCompatActivity {
    private TextView mTextView3;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_text_view);
        mTextView3 = findViewById(R.id.tv_3);
        //set the size of icon
        Drawable icon = getResources().getDrawable(R.drawable.bird);//get icon drawable
        //setBounds(left,top,right,bottom)里的参数从左到右分别是
        //drawable的左边到textview左边缘+padding的距离，drawable的上边离textview上边缘+padding的距离
        //drawable的右边边离textview左边缘+padding的距离，drawable的下边离textview上边缘+padding的距离
        //所以right-left = drawable的宽，top - bottom = drawable的高
        icon.setBounds(0,0,100,100);
        mTextView3.setCompoundDrawables(null, null, icon, null);
    }
-中划线，下划线
下划线两种设置方式
public class TextViewActivity extends AppCompatActivity {
    private TextView mTextView4;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_text_view);
        mTextView4 = findViewById(R.id.tv_4);
        mTextView4.getPaint().setFlags(Paint.STRIKE_THRU_TEXT_FLAG);//中划线，会有锯齿
        mTextView4.getPaint().setAntiAlias(true);//remove 锯齿
        //mTextView4.getPaint().setFlags(Paint.UNDERLINE_TEXT_FLAG);//  下划线
        mTextView4.setText(Html.fromHtml("<u>runninginging</u>"));//html 方式设置下划线,该方式可以与上面中划线共存
        //set the size of icon
        Drawable icon = getResources().getDrawable(R.drawable.bird);//get icon drawable
        //setBounds(left,top,right,bottom)里的参数从左到右分别是
        //drawable的左边到textview左边缘+padding的距离，drawable的上边离textview上边缘+padding的距离
        //drawable的右边边离textview左边缘+padding的距离，drawable的下边离textview上边缘+padding的距离
        //所以right-left = drawable的宽，top - bottom = drawable的高
        icon.setBounds(0,0,100,100);
        mTextView3.setCompoundDrawables(null, null, icon, null);
    }
}
-跑马灯
    <TextView
        android:id="@+id/tv_5"
        android:layout_marginTop="20dp"
        android:layout_width="200dp"
        android:layout_height="wrap_content"
        android:text="我在奔跑我在奔跑"
        android:textColor="#000000"
        android:textSize="30sp"
        android:singleLine="true"
        android:ellipsize="marquee"
        android:marqueeRepeatLimit="marquee_forever"
        android:focusable="true"
        android:focusableInTouchMode="true" />
我在最新的android studio中没有跑马灯效果。暂时无解
```

### 2-3Button

`Button`继承自`TextView`

基本点

文字大小 颜色

```xml-dtd
..layout/activity_button.xml
<Button
        android:id="@+id/btn_1"
        android:text="按钮1"
        android:textSize="26dp"
        android:background="@color/colorPrimaryDark"
        android:textColor="@color/colorAccent"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" />
```

自定义背景形状//圆角

```xml-dtd
..layout/activity_button.xml
<Button
        android:id="@+id/btn_2"
        android:text="按钮2"
        android:textSize="26dp"
        android:layout_below="@id/btn_1"
        android:layout_marginTop="10dp"
        android:background="@drawable/bg_btn2"
        android:textColor="@color/colorAccent"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" />

..drawable/bg_btn2.xml 圆角矩形
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="rectangle">
    <solid
        android:color="@color/colorPrimary"/>
    <corners
        android:radius="15dp"/>
    
</shape>


..drawable/bg_btn3.xml  空心矩形
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
android:shape="rectangle">
<stroke
    android:width="1dp"
    android:color="@color/colorPrimary"/>
<corners
    android:radius="15dp"/>

</shape>

```

自定义按压效果

```xml-dtd
  
..layout/activity_button.xml
  <Button
        android:id="@+id/btn_4"
        android:text="按钮4"
        android:textSize="26dp"
        android:layout_below="@id/btn_3"
        android:layout_marginTop="10dp"
        android:background="@drawable/bg_btn4"
        android:textColor="@color/colorAccent"
        android:onClick="showToast"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" />

..drawable/bg_btn4.xml
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_pressed="true">
        <shape>
            <solid
                android:color="@color/colorPrimary"/>
            <corners
                android:radius="15dp"/>
        </shape>
    </item>

    <item android:state_pressed="false">
        <shape>
            <stroke
                android:width="1dp"
                android:color="@color/colorPrimary"/>
            <corners
                android:radius="15dp"/>

        </shape>
    </item>
</selector>

```

点击事件

```xml-dtd
//第一种方式，不常用
com.example.demo.ButtonActivity

public class ButtonActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_button);
    }
    public void showToast(View view){ //一定要传入 view参数
        Toast.makeText(this,"我被点击了",Toast.LENGTH_SHORT).show();//一定要调用show method

    }
}

..layout/activity_button.xml
  <Button
        android:id="@+id/btn_4"
        android:text="按钮4"
        android:textSize="26dp"
        android:layout_below="@id/btn_3"
        android:layout_marginTop="10dp"
        android:background="@drawable/bg_btn4"
        android:textColor="@color/colorAccent"
        android:onClick="showToast"    //调用showToast method
        android:layout_width="match_parent"
        android:layout_height="wrap_content" />

//第二种更常用的方式
btn3为例
com.example.demo.ButtonActivity

public class ButtonActivity extends AppCompatActivity {
    private Button mBtn3;
    
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_button);
        mBtn3 = findViewById(R.id.btn_3);
        mBtn3.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                Toast.makeText(ButtonActivity.this,"btn3我被点击了",Toast.LENGTH_SHORT).show();//一定要调用show method

            }
        });
    }

tip 因为Button 继承自TextView 所以textview对象也可以应用一样的点击事件方法。
```

tip: `textAllCaps`设为false，关闭默认按钮都是大写的状态

### 2-4EditText 

同样是`TextView`的子类

常用属性

```xml-dtd
..layout/activity_edit_text.xml
    <EditText
        android:id="@+id/et_1"
        android:textSize="16sp"
        android:textColor="@color/colorAccent"
        android:hint="user name"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" />
```

监听事件

```xml-dtd
D:\AndroidStudioProjects\demo\app\src\main\java\com\example\demo\EditTextActivity.java
public class EditTextActivity extends AppCompatActivity {
    private Button mBtnLogin;
    private EditText mBtnUsername;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_edit_text);
        mBtnLogin = findViewById(R.id.btn_login);
		//登录成功的点击事件。打印登录成功信息。
        mBtnLogin.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                Toast.makeText(EditTextActivity.this,"login succesfully ",Toast.LENGTH_SHORT).show();

            }
        });
        mBtnUsername = findViewById(R.id.et_1);
        //设置文字改变的监听事件，在username的editview，i.e. "@+id/et_1" 中监听。
		//监听文字改变的方法，非常常用
        mBtnUsername.addTextChangedListener(new TextWatcher() {
            @Override
            public void beforeTextChanged(CharSequence s, int start, int count, int after) {

            }
            //该方法比较常用， s 就是当前输入框中的内容
            @Override
            public void onTextChanged(CharSequence s, int start, int before, int count) {
                Log.d("edittext",s.toString());//打印 username输入框中的内容

            }

            @Override
            public void afterTextChanged(Editable s) {

            }
        });
    }
}

```

制作登录界面

```xml-dtd
//一个完整的登录界面
..layout/activity_edit_text.xml

    <EditText
        android:id="@+id/et_1"
        android:textSize="16sp"
        android:textColor="@color/colorAccent"
        android:hint="用户名user name"
        android:inputType="number"
        android:layout_width="match_parent"
        android:layout_height="80dp"
        android:background="@drawable/bg_username"
        android:paddingLeft="10dp"
        android:paddingRight="10dp"
        android:maxLines="1"
        android:drawableLeft="@drawable/user_icon"
        android:drawablePadding="30dp"/>

    <EditText
        android:id="@+id/et_2"
        android:layout_below="@+id/et_1"
        android:layout_marginTop="30dp"
        android:textSize="16sp"
        android:textColor="@color/colorAccent"
        android:hint="密码password"
        android:background="@drawable/bg_username"
        android:inputType="textPassword"
        android:layout_width="match_parent"
        android:layout_height="80dp"
        android:maxLines="1"
        android:paddingLeft="10dp"
        android:paddingRight="10dp"
        android:drawablePadding="30dp"
        android:drawableLeft="@drawable/password_icon"/>
    <Button
        android:id="@+id/btn_login"
        android:layout_below="@id/et_2"
        android:layout_marginTop="30dp"
        android:background="@drawable/bg_btn4"
        android:text="login"
        android:textColor="@color/colorAccent"
        android:layout_width="match_parent"
        android:layout_height="40dp" />

public class EditTextActivity extends AppCompatActivity {
    private Button mBtnLogin;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_edit_text);
        mBtnLogin = findViewById(R.id.btn_login);
        mBtnLogin.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                Toast.makeText(EditTextActivity.this,"login succesfully ",Toast.LENGTH_SHORT).show();

            }
        });
    }
}

```



### 2-5 RadioButton

常用属性

```xml-dtd
-checked 该属性是使其默认选中， 设置checked必须有设置id
     <RadioButton
            android:id="@+id/rb_1"
            android:text="man"
            android:textColor="@color/colorAccent"
            android:textSize="36dp"
            android:checked="true"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" />
            
-android:button="@null"
不使用默认button


```

自定义样式

```xml-dtd
 D:\AndroidStudioProjects\demo\app\src\main\res\layout\activity_radio_button.xml
通过把默认button属性设为@null  然后更改背景background属性， 来自定义一个样式
<RadioGroup
        android:id="@+id/rg_2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/rg_1"
        android:layout_marginTop="50dp"
        android:orientation="horizontal">

        <RadioButton
            android:id="@+id/rb_3"
            android:text="man"
            android:gravity="center"
            android:textColor="@color/colorAccent"
            android:textSize="18dp"
            android:button="@null"
            android:background="@drawable/radiobutton"
            android:layout_width="100dp"
            android:layout_height="50dp" />
        <RadioButton
            android:id="@+id/rb_4"
            android:layout_marginLeft="20dp"
            android:gravity="center"
            android:text="woman"
            android:textColor="@color/colorAccent"
            android:textSize="18dp"
            android:button="@null"
            android:background="@drawable/radiobutton"
            android:layout_width="100dp"
            android:layout_height="50dp" />
    </RadioGroup>


```

监听事件

```java
D:\AndroidStudioProjects\demo\app\src\main\java\com\example\demo\RadioButtonActivity.java
public class RadioButtonActivity extends AppCompatActivity {
    private RadioGroup mRg1;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_radio_button);
        mRg1  = findViewById(R.id.rg_1);
        //监听事件，这次是监听checked的变化
        mRg1.setOnCheckedChangeListener(new RadioGroup.OnCheckedChangeListener() {
            @Override
            public void onCheckedChanged(RadioGroup group, int checkedId) {
                RadioButton radioButton = group.findViewById(checkedId);
                Toast.makeText(RadioButtonActivity.this,radioButton.getText(),Toast.LENGTH_SHORT).show();
            }
        });
    }
}
```



#### 2-6复选框CheckBox

常用属性

```
同上节差不多
```

自定义样式

```
button是设置自定义的新按钮
  <CheckBox
            android:id="@+id/cb_5"
            android:layout_below="@+id/tv_2"
            android:text="cook"
            android:textColor="@color/colorAccent"
            android:button="@drawable/bg_checkbox"
            android:textSize="50sp"
            android:paddingLeft="30dp"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" />
```

监听事件

```java
D:\AndroidStudioProjects\demo\app\src\main\java\com\example\demo\CheckBoxActivity.java
与上一节的RadioButton类似，也是监测checked是否变化。
public class CheckBoxActivity extends AppCompatActivity {
    private CheckBox mCb5,mCb6;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_check_box);
        mCb5 = findViewById(R.id.cb_5);
        mCb6 = findViewById(R.id.cb_6);
        mCb5.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
            @Override
            public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
                Toast.makeText(CheckBoxActivity.this,isChecked?"5选中":"5未选中",Toast.LENGTH_SHORT).show();
            }
        });
        mCb6.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
            @Override
            public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
                Toast.makeText(CheckBoxActivity.this,isChecked?"6选中":"6未选中",Toast.LENGTH_SHORT).show();
            }
        });
    }
}
```



### 2-7 ImageView

`Button`衍生控件 还有 `ToggleButton, Switch`

属性

````
-src图片资源
-background 背景画布
-scaleType
fitXY 铺满，宽高比会变化
fitCenter 保持宽高比， 完全显示图片， 背景会裸露
centerCrop 保持宽高比，裁剪图片，不漏背景

````

加载网络图片

```
一种直接记载本地，放到drawable即可加载
一种是网络加载
加载网络图片需要 网络请求权限 INTERNET，在Manifest.xml中声明 一行
    <uses-permission android:name="android.permission.INTERNET"/>
D:\AndroidStudioProjects\demo\app\src\main\java\com\example\demo\ImageViewActivity.java
public class ImageViewActivity extends AppCompatActivity {
    private ImageView mIv4;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_image_view);
        mIv4 = findViewById(R.id.iv_2);
        Glide.with(this).load("https://www.baidu.com/img/bd_logo1.png?where=super").into(mIv4);
    }
}
```

tip：第三方jar包放在app>libs中，供引用

as可以通过gradle引用管理



### 2-8ListView

常用属性

```
重要属性  setAdapter(adapter)
listSelector 可以设置选中时候的一些状态特性，变色等等
divider设置 list不同item直接的分界线特性
 <ListView
       android:id="@+id/lv_1"
       android:layout_width="wrap_content"
       android:layout_height="wrap_content"
       android:divider="@color/colorAccent"
       android:listSelector="@drawable/list_item">
```

Adapter接口

```java
D:\AndroidStudioProjects\demo\app\src\main\java\com\example\demo\listview\ListViewActivity.java
public class ListViewActivity extends AppCompatActivity {
    private ListView mLv1;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_list_view);
        mLv1 = findViewById(R.id.lv_1);
        mLv1.setAdapter(new MyListAdapter(ListViewActivity.this));
    }
}



D:\AndroidStudioProjects\demo\app\src\main\java\com\example\demo\listview\MyListAdapter.java
public class MyListAdapter extends BaseAdapter {
    private Context mContext;
    private LayoutInflater mLayoutInflater;
    public MyListAdapter(Context context){
        this.mContext = context;
        mLayoutInflater = LayoutInflater.from(context);
    }

    @Override
    public int getCount() {
        return 10;  //实际开发中不是固定的
    }

    @Override
    public Object getItem(int position) {
        return null;
    }

    @Override
    public long getItemId(int position) {
        return 0;
    }

    // 复用性好的写法
    static class  ViewHolder{
        public ImageView imageView;
        public TextView tvTitle,tvContent,tvTime;
    }


    //上面三个方法不太常用，  getView()非常重要
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        ViewHolder holder = null;
        if(convertView == null){
            convertView = mLayoutInflater.inflate(R.layout.layout_list_item,null);
            holder = new ViewHolder();
            holder.imageView  = convertView.findViewById(R.id.iv);
            holder.tvContent = convertView.findViewById(R.id.tv_content);
            holder.tvTime = convertView.findViewById(R.id.tv_time);
            holder.tvTitle = convertView.findViewById(R.id.tv_title);
            convertView.setTag(holder);
        }else{
            holder = (ViewHolder) convertView.getTag();
        }
        holder.tvTitle.setText("这是标题");
        holder.tvTime.setText("2999.0.3");
        holder.tvContent.setText("这是内容");
        Glide.with(mContext).load("https://tse1.mm.bing.net/th?id=AMMS_a7fc1af540851fa81416f9d842b5847c&w=236&h=183&c=8&rs=1&o=5&pid=3.1&rm=2").into(holder.imageView);
        return convertView;
    }

}

相关教程
http://www.runoob.com/w3cnote/android-tutorial-listview.html

```

设置点击事件，长按事件

```java
public class ListViewActivity extends AppCompatActivity {
    private ListView mLv1;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_list_view);
        mLv1 = findViewById(R.id.lv_1);
        mLv1.setAdapter(new MyListAdapter(ListViewActivity.this));
        //点击
        mLv1.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            @Override
            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
                Toast.makeText(ListViewActivity.this,"pos:"+position,Toast.LENGTH_SHORT).show();
            }

        });
        mLv1.setOnItemLongClickListener(new AdapterView.OnItemLongClickListener() {
            @Override
            public boolean onItemLongClick(AdapterView<?> parent, View view, int position, long id) {
                Toast.makeText(ListViewActivity.this,"长按pos:"+position,Toast.LENGTH_SHORT).show();
                return true;//标志 已经处理完成，其余响应不再处理
            }
        });
    }
}



```

遇到的bug：新建了一个package  listview。  在package中新建了`ListViewActivity`， 然后在`ListViewActivity`中无法导入R.layout.activity_list_new 布局，找不到。

解决： 删除了一点layout.activity_list_new 内容，再撤销回去， 就神奇的好了。



#### Ps:Adapter 知识

![img](https://pic002.cnblogs.com/images/2012/267603/2012012021592978.jpg)

![img](https://pic002.cnblogs.com/images/2012/267603/2012012021594986.png)



Android是完全遵循MVC模式设计的框架,Activity是Controller,layout是View 

因为layout五花八门,很多数据都不能直接绑定上去,所以Android引入了Adapter这个机制作为复杂数据的展示的转换载体,所以各种Adapter只不过是转换的方式和能力不一样而已。 





### 2-9网格视图

类似listview属性有所不同

```java
com.example.demo.gridview.GridViewActivity

public class GridViewActivity extends AppCompatActivity {
    private GridView mGv;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_grid_view);
        mGv = findViewById(R.id.gv);
        mGv.setAdapter(new MyGridViewAdapter(GridViewActivity.this));
        mGv.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            @Override
            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
                Toast.makeText(GridViewActivity.this, "点击 ppos " + position, Toast.LENGTH_SHORT).show();
            }
        });
        mGv.setOnItemLongClickListener(new AdapterView.OnItemLongClickListener() {
            @Override
            public boolean onItemLongClick(AdapterView<?> parent, View view, int position, long id) {
                Toast.makeText(GridViewActivity.this, "长按pos:" + position, Toast.LENGTH_SHORT).show();
                return true;//标志 已经处理完成，其余响应不再处理
            }
        });
    }
}


com.example.demo.gridview.MyGridViewAdapter


public class MyGridViewAdapter extends BaseAdapter {
    private Context mContext;
    private LayoutInflater mLayoutInflater;
    public MyGridViewAdapter(Context context){
        this.mContext = context;
        mLayoutInflater = LayoutInflater.from(context);
    }

    @Override
    public int getCount() {
        return 10;
    }

    @Override
    public Object getItem(int position) {
        return null;
    }

    @Override
    public long getItemId(int position) {
        return 0;
    }
    static class ViewHolder{
        public ImageView imageView;
        public TextView textView;
    }
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {//定义每个格子的 样子
        ViewHolder holder = null;
        if(convertView == null){
            convertView = mLayoutInflater.inflate(R.layout.layout_grid_item,null);
            holder = new ViewHolder();
            holder.imageView  = convertView.findViewById(R.id.iv_grid);
            holder.textView = convertView.findViewById(R.id.tv_grid);
            convertView.setTag(holder);
        }else{
            holder = (ViewHolder) convertView.getTag();
        }
        holder.textView.setText("樱花");
        // give image to imageView
        Glide.with(mContext).load("https://tse1.mm.bing.net/th?id=AMMS_a7fc1af540851fa81416f9d842b5847c&w=236&h=183&c=8&rs=1&o=5&pid=3.1&rm=2").into(holder.imageView);
        return convertView;
    }
}





```



layout

```x&#39;m
######layout/activity_grid_view.xml

<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent">


    <GridView
        android:id="@+id/gv"
        android:numColumns="3"
        android:horizontalSpacing="3dp"
        android:verticalSpacing="3dp"
        android:layout_width="match_parent"
        android:layout_height="wrap_content">

    </GridView>

</RelativeLayout>

######layout/layout_grid_item.xml
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:padding="36dp">
    <ImageView
        android:id="@+id/iv_grid"
        android:background="@color/colorPrimary"  
        android:layout_width="match_parent"
        android:layout_height="80dp"
        android:scaleType="fitCenter"/>
    <TextView
        android:id="@+id/tv_grid"
        android:layout_marginTop="10dp"
        android:text="hello hello"
        android:gravity="center"
        android:textColor="@color/colorAccent"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" />

</LinearLayout>
```



### 2.10 ScrollView

垂直滚动 `ScrollView`

水平滚动 `HorizontalScrollView`

```xml-dtd
子元素只能有一个，一般用LinearLayout等布局作为子元素，子元素中再放更多按钮等元素。

<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity">
     <LinearLayout
         android:orientation="vertical"
         android:layout_width="match_parent"
         android:layout_height="wrap_content">

         <Button
             android:id="@+id/btn_textview"
             android:text="textview"
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
             android:textAllCaps="false"/>
         <Button
             android:id="@+id/btn_button"
             android:text="button"
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
             android:textAllCaps="false"/>
         <Button
             android:id="@+id/btn_test"
             android:text="Test"
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
             android:layout_marginTop="500dp"
             android:textAllCaps="false"/>
             
         <HorizontalScrollView
             android:layout_width="wrap_content"
             android:layout_height="wrap_content">
             <LinearLayout
                 android:orientation="horizontal"
                 android:layout_width="match_parent"
                 android:layout_height="match_parent">
                 <Button
                     android:text="Test"
                     android:layout_width="300dp"
                     android:layout_height="200dp"
                     android:textAllCaps="false"/>
                 <Button
                     android:text="Test"
                     android:layout_width="300dp"
                     android:layout_height="200dp"
                     android:textAllCaps="false"/>
             </LinearLayout>
         </HorizontalScrollView>

     </LinearLayout>

</ScrollView>


```



### 2.11 RecyclerView

为了‘’灵活‘’ 展示大数据集

视图复用管理更好，可以显示列表 网格 瀑布流等形式。 不同的`ViewHolder`能够实现`item`多元化

使用起来麻烦一点

没有类似`ListView` 的`OnItemClickListener`监听事件，要自己实现



第一步，`gradle`引入 包

```xml-dtd
D:\AndroidStudioProjects\demo\app\build.gradle
dependencies {
    implementation fileTree(dir: 'libs', include: ['*.jar'])
    implementation 'com.android.support:appcompat-v7:28.0.0'
    implementation 'com.android.support.constraint:constraint-layout:1.1.3'
    testImplementation 'junit:junit:4.12'
    androidTestImplementation 'com.android.support.test:runner:1.0.2'
    androidTestImplementation 'com.android.support.test.espresso:espresso-core:3.0.2'

    implementation 'com.github.bumptech.glide:glide:4.9.0'
    annotationProcessor 'com.github.bumptech.glide:compiler:4.9.0'
    implementation 'com.android.support:recyclerview-v7:28.0.0' //引入 recyclerview，版本号需要与第二行的: implementation 'com.android.support:appcompat-v7:28.0.0'  一致
}



```

第一个 

列表试图 `LinearRecycleView`

```

1 layout中写一个RecycleView视图
2 com.example.demo.recyclerview.LinearRecyclerViewActivity  中 声明控件
    private RecyclerView mRvMain;//声明控件
    mRvMain = findViewById(R.id.rv_main);//找到控件

3 设置布局管理器， 括号中三种类型Linear... Grid... StaggeredGrid...，这里选择的  LinearLayoutManager 是列表布局
-mRvMain.setLayoutManager(new LinearLayoutManager(LinearRecyclerViewActivity.this));

4 新建一个Adapter ，叫做LinearAdapter
subclass 类型选择  android.support.v7.widget.RecyclerView.Adapter
- mRvMain.setAdapter();


ItemDecoration()

三个方法
Ondraw() item之前
OnDrawOver()  item 之后
getItemOffsets() 周边，  --可以实现分割线



```



```java
com.example.demo.recyclerview.LinearRecyclerViewActivity
package com.example.demo.recyclerview;

public class LinearRecyclerViewActivity extends AppCompatActivity {
    private RecyclerView mRvMain;//声明控件
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_linear_recycler_view);
        mRvMain = findViewById(R.id.rv_main);//找到控件
        mRvMain.setLayoutManager(new LinearLayoutManager(LinearRecyclerViewActivity.this));
        mRvMain.addItemDecoration(new MyDecoration());//实现分割线
        mRvMain.setAdapter(new LinearAdapter(LinearRecyclerViewActivity.this, new LinearAdapter.OnItemClickListener() {
            @Override
            public void onClick(int pos) {
                Toast.makeText(LinearRecyclerViewActivity.this,"click"+pos,Toast.LENGTH_SHORT).show();
            }
        }));

    }

    class MyDecoration extends RecyclerView.ItemDecoration{
        @Override
        public void getItemOffsets(@NonNull Rect outRect, @NonNull View view, @NonNull RecyclerView parent, @NonNull RecyclerView.State state) {
            super.getItemOffsets(outRect, view, parent, state);
            //每个item下面加1dp的间距  颜色是背景颜色
            outRect.set(0,0,0,getResources().getDimensionPixelOffset(R.dimen.divideHeight));
        }
    }

}

com.example.demo.recyclerview.LinearAdapter

public class LinearAdapter extends RecyclerView.Adapter<LinearAdapter.LinearViewHolder> { // Adapter 类有一个泛型
    // public abstract static class Adapter<VH extends RecyclerView.ViewHolder> {
    //所以我们要实现一个 新的class  LinearViewHolder（）,  泛型也改成我们实现的LinearAdapter.LinearViewHolder
    private Context mcontext;
    private OnItemClickListener mlistener;
    public  LinearAdapter(Context context,OnItemClickListener listener){//实现构造方法， 给context赋值
        this.mcontext = context;
        this.mlistener = listener;
    }
    @NonNull
    @Override
    public LinearAdapter.LinearViewHolder onCreateViewHolder(@NonNull ViewGroup viewGroup, int i) {
        //返回一个viewholder， viewholder 被传入一个布局
        return new LinearViewHolder(LayoutInflater.from(mcontext).inflate(R.layout.layout_linear_item,viewGroup,false));
    }

    @Override
    public void onBindViewHolder(@NonNull LinearAdapter.LinearViewHolder viewHolder, final int i) {
        viewHolder.textView.setText("hello world hahahaha");
        viewHolder.itemView.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                mlistener.onClick(i);
            }
        });
    }

    @Override
    public int getItemCount() {//列表的长度
        return 30;
    }
    class LinearViewHolder extends RecyclerView.ViewHolder{
        private TextView textView;
        public LinearViewHolder(View itemView){//实现构造方法
            super(itemView);
            textView = itemView.findViewById(R.id.tv_title);
        }
    }
    //为了在 activity中 定义 监听操作，  定义一个借口
    public interface OnItemClickListener{
        void onClick(int pos);
    }
}

activity_linear_recycler_view.xml
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".recyclerview.LinearRecyclerViewActivity">
    
    <android.support.v7.widget.RecyclerView
        android:id="@+id/rv_main"
        android:background="@color/colorAccent"
        android:layout_width="match_parent"
        android:layout_height="600dp">
    </android.support.v7.widget.RecyclerView>
</RelativeLayout>
layout_linear_item.xml
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content">
    <TextView
        android:id="@+id/tv_title"
        android:text="linear text"
        android:background="@color/colorPrimary"
        android:textColor="@color/colorAccent"
        android:gravity="center"
        android:textSize="50sp"
        android:layout_width="match_parent"
        android:layout_height="66dp" />
</LinearLayout>
```



水平滚动 

```java
//与 linearrecyclerview 竖直滚动基本一样。
LinearLayoutManager linearLayoutManager = new LinearLayoutManager(HorRecycleViewActivity.this);
linearLayoutManager.setOrientation(LinearLayoutManager.HORIZONTAL);
mRvHor.setLayoutManager(linearLayoutManager);
//只是在 layoutmanager 初始化设置为HORIZONTAL
```

网格布局

```java
com.example.demo.recyclerview.GridRecyclerViewActivity
//基本类似于LinearLayoutManager,
public class GridRecyclerViewActivity extends AppCompatActivity {
    private RecyclerView mRvGrid;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_grid_recycler_view);
        mRvGrid = findViewById(R.id.rv_grid);
        mRvGrid.setLayoutManager(new 		 	GridLayoutManager(GridRecyclerViewActivity.this,3));//每行显示三个 格子
        mRvGrid.setAdapter(new GridAdapter(GridRecyclerViewActivity.this, new GridAdapter.OnItemClickListener() {
            @Override
            public void onClick(int pos) {
                Toast.makeText(GridRecyclerViewActivity.this, "click "+pos, Toast.LENGTH_SHORT).show();
            }
        }));
    }
}


```





瀑布流

![img](https://github.com/ziming-liu/Images/blob/master/AndroidDemo/Snipaste_2019-04-10_20-31-31.png?raw=true)

变化了两处，1）`layoutManager`的设置2）`Adapter`中`onBindViewHolder（）`实现的是`imageView`， 不是`textView`

```java
//com.example.demo.recyclerview.PuRecyclerViewActivity

public class PuRecyclerViewActivity extends AppCompatActivity {
    private RecyclerView mRvPu;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_pu_recycler_view);
        mRvPu = findViewById(R.id.rv_pu);
        mRvPu.setLayoutManager(new StaggeredGridLayoutManager(2, StaggeredGridLayoutManager.VERTICAL));//2列
        mRvPu.addItemDecoration(new MyDecoration());
        mRvPu.setAdapter(new StaggeredGridAdapter(PuRecyclerViewActivity.this, new StaggeredGridAdapter.OnItemClickListener() {
            @Override
            public void onClick(int pos) {
                Toast.makeText(PuRecyclerViewActivity.this, "click " + pos, Toast.LENGTH_SHORT).show();
            }
        }));
    }

    class MyDecoration extends RecyclerView.ItemDecoration {
        @Override
        public void getItemOffsets(@NonNull Rect outRect, @NonNull View view, @NonNull RecyclerView parent, @NonNull RecyclerView.State state) {
            super.getItemOffsets(outRect, view, parent, state);
            //每个item加5dp的间距  颜色是背景颜色
            int gap = getResources().getDimensionPixelOffset(R.dimen.divideHeightMax);
            outRect.set(gap, gap, gap, gap);
        }
    }
}

//com.example.demo.recyclerview.StaggeredGridAdapter

public class StaggeredGridAdapter extends RecyclerView.Adapter<StaggeredGridAdapter.LinearViewHolder> { // Adapter 类有一个泛型
    // public abstract static class Adapter<VH extends RecyclerView.ViewHolder> {
    //所以我们要实现一个 新的class  LinearViewHolder（）,  泛型也改成我们实现的LinearAdapter.LinearViewHolder
    private Context mcontext;
    private OnItemClickListener mlistener;
    public StaggeredGridAdapter(Context context, OnItemClickListener listener){//实现构造方法， 给context赋值
        this.mcontext = context;
        this.mlistener = listener;
    }
    @NonNull
    @Override
    public StaggeredGridAdapter.LinearViewHolder onCreateViewHolder(@NonNull ViewGroup viewGroup, int i) {
        //返回一个viewholder， viewholder 被传入一个布局
        return new LinearViewHolder(LayoutInflater.from(mcontext).inflate(R.layout.layout_staggered_grid_item,viewGroup,false));
    }

    @Override
    public void onBindViewHolder(@NonNull StaggeredGridAdapter.LinearViewHolder viewHolder, final int i) {
        if(i%2!=0)
            viewHolder.imageView.setImageResource(R.drawable.img0);
        else
            viewHolder.imageView.setImageResource(R.drawable.img1);
        viewHolder.itemView.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                mlistener.onClick(i);
            }
        });
    }

    @Override
    public int getItemCount() {//列表的长度
        return 80;
    }


    class LinearViewHolder extends RecyclerView.ViewHolder{
        private ImageView imageView;
        public LinearViewHolder(View itemView){//实现构造方法
            super(itemView);
            imageView = itemView.findViewById(R.id.iv);
        }
    }
    //为了在 activity中 定义 监听操作，  定义一个借口
    public interface OnItemClickListener{
        void onClick(int pos);
    }
}
```



不同的`ViewHolder`

主要是`Adapter`修改，实现多个不同的`ViewHolder`

```java
在前面的recyclerview的列表视图基础上修改的代码

1）修改Adapter
2）新建一个layout_linear_item2.xml。包含imageview
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="match_parent"
    android:layout_height="wrap_content">
    <TextView
        android:id="@+id/tv_title"
        android:text="小狮子"
        android:background="@color/colorPrimary"
        android:textColor="@color/colorWhite"
        android:gravity="center"
        android:textSize="50sp"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" />

    <ImageView
        android:id="@+id/iv_image"
        android:src="@drawable/img0"
        android:background="@color/colorPrimary"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" />
</LinearLayout>


//com.example.demo.recyclerview.LinearAdapter

public class LinearAdapter extends RecyclerView.Adapter<RecyclerView.ViewHolder> { // 因为实现了多个不同的LinearViewHoler(),
    //所以， 泛型都是  RecyclerView.ViewHolder ， 而不是 一开始Recyclerview列表视图中直接用LinearViewHolder
    private Context mcontext;
    private OnItemClickListener mlistener;
    public  LinearAdapter(Context context,OnItemClickListener listener){//实现构造方法， 给context赋值
        this.mcontext = context;
        this.mlistener = listener;
    }
    @NonNull
    @Override
    public RecyclerView.ViewHolder onCreateViewHolder(@NonNull ViewGroup viewGroup, int viewType) {//按照规则，即viewType，返回不同的viewholder
        if(viewType==0)
            //返回一个viewholder， viewholder 被传入一个布局
            return new LinearViewHolder(LayoutInflater.from(mcontext).inflate(R.layout.layout_linear_item,viewGroup,false));
        else
            return new LinearViewHolder2(LayoutInflater.from(mcontext).inflate(R.layout.layout_linear_item2,viewGroup,false));
    }

    @Override
    public void onBindViewHolder(@NonNull RecyclerView.ViewHolder viewHolder, final int i) {//对不同的viewholder有不同的执行
        if(getItemViewType(i)==0) {
            ((LinearViewHolder) viewHolder).textView.setText("hello world!");
        }
        else{
            ((LinearViewHolder2)viewHolder).textView.setText("狮子王");
        }
        viewHolder.itemView.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                mlistener.onClick(i);
            }
        });
    }

    @Override
    public int getItemViewType(int position){//定义规则，什么情况用哪种viewholder
        if(position %2==0)
            return 0;
        else
            return 1;
    }

    @Override
    public int getItemCount() {//列表的长度
        return 50;
    }

    class LinearViewHolder extends RecyclerView.ViewHolder{
        private TextView textView;
        public LinearViewHolder(View itemView){//实现构造方法
            super(itemView);
            textView = itemView.findViewById(R.id.tv_title);
        }
    }
    //定义一种新的viewholder
    class LinearViewHolder2 extends RecyclerView.ViewHolder{
        private TextView textView;
        private ImageView imageView;
        public LinearViewHolder2(View itemView){//实现构造方法
            super(itemView);
            textView = itemView.findViewById(R.id.tv_title);
            imageView = itemView.findViewById(R.id.iv_image);
        }
    }
    //为了在 activity中 定义 监听操作，  定义一个借口
    public interface OnItemClickListener{
        void onClick(int pos);
    }
}


```

搜索`github`  轮子： `XRcyclerView`  --> `addHeadView, addFootView,  下拉刷新，上拉加载`



























